#!/bin/bash

# Usage (temp_file is used so you can execute different commands automatically when entering chroot)
# To create: zilla -create disto name
# To enter most chroots: zilla -enter name temp_file
# To enter chroots with special edge cases (ex Alpine): zilla -enter name temp_file distro

case $1 in
        -create)
                case $2 in
                        ubuntu)
                                /usr/bin/debootstrap --variant=buildd focal /mnt/chroot/$3 http://archive.ubuntu.com/ubuntu/
                                /usr/bin/cp /mnt/dist-data/ubuntu/sources.list /mnt/chroot/$3/etc/apt/sources.list
                                /usr/bin/cp /mnt/dist-data/ubuntu/.bashrc /mnt/chroot/$3/root/.bashrc
                                ;;
                        alpine)
                                echo "Add alpine implementation here"
                                cd /mnt/chroot/
                                sudo alpine-chroot-install -d /mnt/chroot/$3 -p build-base -p cmake
                                ;;
                        arch)
                                CHROOT=/mnt/chroot/$3
                                /usr/bin/mkchroot $CHROOT base-devel
                                /usr/bin/rm $3.lock
                                /usr/bin/cp /mnt/dist-data/arch/.bashrc /mnt/chroot/$3/root/.bashrc
                                /usr/bin/cp /mnt/dist-data/arch/pacman.conf /mnt/chroot/$3/etc/pacman.conf
                                /usr/bin/cp /mnt/dist-data/arch/sudoers /mnt/chroot/$3/etc/sudoers
                                /usr/bin/cp /mnt/dist-data/arch/.bash_profile /mnt/chroot/$3/root/.bash_profile
                                cd /mnt/chroot/$3/usr/local/bin
                                /usr/bin/wget https://raw.githubusercontent.com/FriedMicro/frost/main/frost
                                /usr/bin/chmod +x frost
                                ;;
                esac
                ;;
        -enter)
                case $4 in
                        alpine)
                                /mnt/chroot/$2/enter-chroot
                                ;;
                        *)
                                cd /mnt/chroot/$2
                                /usr/bin/touch ./root/$3
                                /usr/bin/groot
                                /usr/bin/rm ./root/$3
                                ;;
                esac
                ;;
        *)
                echo "-create <base> <name>, -enter <chroot name> <tmp file>"
                ;;
esac
